{% extends 'base.html' %}
{% block content %}
<div class="row">
  <div class="col-md-6">
    <div class="card p-4">
      <h5>Профиль</h5>
      <form method="post">
        <input type="hidden" name="update_profile" value="1">
        <div class="mb-2">
          <label class="form-label">Фамилия</label>
          <input class="form-control" name="last_name" value="{{ client.last_name }}">
        </div>
        <div class="mb-2">
          <label class="form-label">Имя</label>
          <input class="form-control" name="first_name" value="{{ client.first_name }}">
        </div>
        <div class="mb-2">
          <label class="form-label">Отчество</label>
          <input class="form-control" name="middle_name" value="{{ client.middle_name or '' }}">
        </div>
        <div class="mb-2">
          <label class="form-label">Телефон</label>
          <input class="form-control" name="phone" value="{{ client.phone }}">
        </div>
        <div class="d-grid">
          <button class="btn btn-primary">Сохранить</button>
        </div>
      </form>
    </div>
    <div class="card p-4 mt-3">
      <h6>Сменить пароль</h6>
      <form method="post">
        <input type="hidden" name="change_password" value="1">
        <div class="mb-2">
          <label class="form-label">Текущий пароль</label>
          <input class="form-control" name="old_password" type="password">
        </div>
        <div class="mb-2">
          <label class="form-label">Новый пароль</label>
          <input class="form-control" name="new_password" type="password">
        </div>
        <div class="d-grid">
          <button class="btn btn-outline-primary">Изменить пароль</button>
        </div>
      </form>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card p-4">
      <h5>История заказов</h5>
      <table class="table">
        <thead>
          <tr><th>#</th><th>Дата</th><th>Модель</th><th>Статус</th><th class="text-end">Итого</th></tr>
        </thead>
        <tbody>
          {% for order in client.orders|sort(attribute='received_date', reverse=True) %}
          <tr>
            <td>{{ order.work_order_id }}</td>
            <td>{{ order.received_date | date_fmt }}</td>
            <td>{{ order.phone_model }}</td>
            <td>
              {% if order.status == 'Принят' %}
                <span class="badge bg-info">{{ order.status }}</span>
              {% elif order.status == 'В ремонте' %}
                <span class="badge bg-warning text-dark">{{ order.status }}</span>
              {% elif order.status == 'Ожидает запчасти' %}
                <span class="badge bg-danger">{{ order.status }}</span>
              {% elif order.status == 'Готов к выдаче' %}
                <span class="badge bg-success">{{ order.status }}</span>
              {% elif order.status == 'Выдан' %}
                <span class="badge bg-primary">{{ order.status }}</span>
              {% elif order.status == 'Отменен' %}
                <span class="badge bg-secondary">{{ order.status }}</span>
              {% else %}
                <span class="badge bg-dark">{{ order.status }}</span>
              {% endif %}
            </td>
            <td class="text-end">{{ order.total_cost | rubles }}</td>
          </tr>
          {% else %}
          <tr><td colspan="5" class="text-center text-muted">Нет заказов</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
